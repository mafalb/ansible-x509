---

- block:
    - debug: var=playbook_dir
    - debug: msg="the key is {{ lookup('file', playbook_dir + '/' + key) }}"
  tags:
    - debug
    - never

- name: certificate does exist
  copy:
    src: "{{ playbook_dir }}/{{ cert }}"
    dest: /tmp/{{ alias }}.cert

- name: root certificate does exist
  copy:
    src: "{{ playbook_dir }}/{{ root }}"
    dest: /tmp/{{ alias }}.rootcert

- name: key does exist
  copy:
    src: "{{ playbook_dir }}/{{ key }}"
    dest: /tmp/{{ alias }}.key
    mode: g-rwx,o-rwx

- name: pem file does exist
  template:
    src: pem.j2
    dest: /tmp/{{ alias }}.pem
    mode: g-rwx,o-rwx
